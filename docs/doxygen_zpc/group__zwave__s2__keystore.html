<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Z-Wave Protocol Controller Refrence: Security 2 Keystore</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Z-Wave Protocol Controller Refrence<span id="projectnumber">&#160;1.6.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__zwave__s2__keystore.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Security 2 Keystore<div class="ingroups"><a class="el" href="group__zwave__controller.html">Z-Wave Controller</a> &raquo; <a class="el" href="group__zwave__transports.html">Z-Wave Transports</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Z-Wave Keystore.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga35f3a041ee4a3465cf4675357f420cb8"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__zwave__s2__keystore.html#ga35f3a041ee4a3465cf4675357f420cb8">zwave_s2_keystore_ecdh_key_mode_t</a> { <a class="el" href="group__zwave__s2__keystore.html#gga35f3a041ee4a3465cf4675357f420cb8ad230e2d1c6e316af6b091113ef4b6cd5">ZWAVE_S2_KEYSTORE_STATIC_ECDH_KEY</a>
, <a class="el" href="group__zwave__s2__keystore.html#gga35f3a041ee4a3465cf4675357f420cb8a1c5e7f52deb922e278543daf52bfa99e">ZWAVE_S2_KEYSTORE_DYNAMIC_ECDH_KEY</a>
 }</td></tr>
<tr class="memdesc:ga35f3a041ee4a3465cf4675357f420cb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">ECDH key mode types.  <a href="group__zwave__s2__keystore.html#ga35f3a041ee4a3465cf4675357f420cb8">More...</a><br /></td></tr>
<tr class="separator:ga35f3a041ee4a3465cf4675357f420cb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaaa90915209c3b118a05cc8adb221f83e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__zwave__s2__keystore.html#gaaa90915209c3b118a05cc8adb221f83e">zwave_s2_keystore_get_dsk</a> (<a class="el" href="group__zwave__s2__keystore.html#ga35f3a041ee4a3465cf4675357f420cb8">zwave_s2_keystore_ecdh_key_mode_t</a> mode, <a class="el" href="group__zwave__controller__types.html#ga437b381aa677af21a3c25f4587bda65b">zwave_dsk_t</a> dsk)</td></tr>
<tr class="memdesc:gaaa90915209c3b118a05cc8adb221f83e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return one of the DSKs of the controller.  <a href="group__zwave__s2__keystore.html#gaaa90915209c3b118a05cc8adb221f83e">More...</a><br /></td></tr>
<tr class="separator:gaaa90915209c3b118a05cc8adb221f83e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga42cbe7b3856c32fcde78b52c3b0be2ae"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__zwave__s2__keystore.html#ga42cbe7b3856c32fcde78b52c3b0be2ae">zwave_s2_keystore_get_assigned_keys</a> ()</td></tr>
<tr class="memdesc:ga42cbe7b3856c32fcde78b52c3b0be2ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the set of the currently assigned keys.  <a href="group__zwave__s2__keystore.html#ga42cbe7b3856c32fcde78b52c3b0be2ae">More...</a><br /></td></tr>
<tr class="separator:ga42cbe7b3856c32fcde78b52c3b0be2ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f2ffcd45d335cc55446098a1b970cf6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__zwave__s2__keystore.html#ga5f2ffcd45d335cc55446098a1b970cf6">zwave_s2_keystore_reset_assigned_keys</a> ()</td></tr>
<tr class="memdesc:ga5f2ffcd45d335cc55446098a1b970cf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the list of assigned keys (sets them to 0) Use this function before receiving keys when entering in a network.  <a href="group__zwave__s2__keystore.html#ga5f2ffcd45d335cc55446098a1b970cf6">More...</a><br /></td></tr>
<tr class="separator:ga5f2ffcd45d335cc55446098a1b970cf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaca2ffce4fcd92466c1eaa43e7c5dbaab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__zwave__s2__keystore.html#gaca2ffce4fcd92466c1eaa43e7c5dbaab">zwave_s2_create_new_network_keys</a> ()</td></tr>
<tr class="separator:gaca2ffce4fcd92466c1eaa43e7c5dbaab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6e7eb7c062ee0f17a650a0e7ca7c9831"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__zwave__s2__keystore.html#ga6e7eb7c062ee0f17a650a0e7ca7c9831">zwave_s2_log_security_keys</a> (<a class="el" href="group__sl__log.html#gacd69524374ffb27db69ca4d5ed0e6851">sl_log_level_t</a> log_level)</td></tr>
<tr class="separator:ga6e7eb7c062ee0f17a650a0e7ca7c9831"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac49dbe5742fe551166c94f1123e9ab79"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__zwave__s2__keystore.html#gac49dbe5742fe551166c94f1123e9ab79">zwave_s2_save_security_keys</a> (const char *filename)</td></tr>
<tr class="separator:gac49dbe5742fe551166c94f1123e9ab79"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >Z-Wave Keystore. </p>
<p >The Z-Wave keystore is storing, accesing and gerating the Z-Wave network keys as well as the ECDH keys which are used in Security 2. All keys are stored in the NVM of the Z-Wave module. </p>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga35f3a041ee4a3465cf4675357f420cb8" name="ga35f3a041ee4a3465cf4675357f420cb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga35f3a041ee4a3465cf4675357f420cb8">&#9670;&nbsp;</a></span>zwave_s2_keystore_ecdh_key_mode_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__zwave__s2__keystore.html#ga35f3a041ee4a3465cf4675357f420cb8">zwave_s2_keystore_ecdh_key_mode_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ECDH key mode types. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga35f3a041ee4a3465cf4675357f420cb8ad230e2d1c6e316af6b091113ef4b6cd5" name="gga35f3a041ee4a3465cf4675357f420cb8ad230e2d1c6e316af6b091113ef4b6cd5"></a>ZWAVE_S2_KEYSTORE_STATIC_ECDH_KEY&#160;</td><td class="fielddoc"><p >This is a static key used for being included when at least one Authenticated Security Class is granted. It matches the ZPC's DSK exchanged out of band. This key is fetched from the NVM of the module. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga35f3a041ee4a3465cf4675357f420cb8a1c5e7f52deb922e278543daf52bfa99e" name="gga35f3a041ee4a3465cf4675357f420cb8a1c5e7f52deb922e278543daf52bfa99e"></a>ZWAVE_S2_KEYSTORE_DYNAMIC_ECDH_KEY&#160;</td><td class="fielddoc"><p >This is a dynamic key used for</p><ol type="1">
<li>Including new nodes (add mode)</li>
<li>Being included when no Authenticated Security Class is granted. The key must be regenerated after each S2 bootstrapping attempt </li>
</ol>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaca2ffce4fcd92466c1eaa43e7c5dbaab" name="gaca2ffce4fcd92466c1eaa43e7c5dbaab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaca2ffce4fcd92466c1eaa43e7c5dbaab">&#9670;&nbsp;</a></span>zwave_s2_create_new_network_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zwave_s2_create_new_network_keys </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Create new random network keys, which marks all keys as granted. </p>

</div>
</div>
<a id="ga42cbe7b3856c32fcde78b52c3b0be2ae" name="ga42cbe7b3856c32fcde78b52c3b0be2ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga42cbe7b3856c32fcde78b52c3b0be2ae">&#9670;&nbsp;</a></span>zwave_s2_keystore_get_assigned_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t zwave_s2_keystore_get_assigned_keys </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the set of the currently assigned keys. </p>
<dl class="section return"><dt>Returns</dt><dd>uint8_t Bit field of keys </dd></dl>

</div>
</div>
<a id="gaaa90915209c3b118a05cc8adb221f83e" name="gaaa90915209c3b118a05cc8adb221f83e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaa90915209c3b118a05cc8adb221f83e">&#9670;&nbsp;</a></span>zwave_s2_keystore_get_dsk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zwave_s2_keystore_get_dsk </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__zwave__s2__keystore.html#ga35f3a041ee4a3465cf4675357f420cb8">zwave_s2_keystore_ecdh_key_mode_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__zwave__controller__types.html#ga437b381aa677af21a3c25f4587bda65b">zwave_dsk_t</a>&#160;</td>
          <td class="paramname"><em>dsk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return one of the DSKs of the controller. </p>
<p >This function can be used fetch the DSK of the controller. There are two use cases of this, as follows:</p><ol type="1">
<li>When including the controller into an other z-wave network, in this case the ZWAVE_S2_KEYSTORE_STATIC_ECDH_KEY should be used.</li>
<li>When including a node using CSA inclusion, In this case the ZWAVE_S2_KEYSTORE_DYNAMIC_ECDH_KEY should be used.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mode</td><td>Which dsk to get. </td></tr>
    <tr><td class="paramname">dsk</td><td>pointer to a zwave_dsk_t to copy the dsk to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga5f2ffcd45d335cc55446098a1b970cf6" name="ga5f2ffcd45d335cc55446098a1b970cf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5f2ffcd45d335cc55446098a1b970cf6">&#9670;&nbsp;</a></span>zwave_s2_keystore_reset_assigned_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zwave_s2_keystore_reset_assigned_keys </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets the list of assigned keys (sets them to 0) Use this function before receiving keys when entering in a network. </p>

</div>
</div>
<a id="ga6e7eb7c062ee0f17a650a0e7ca7c9831" name="ga6e7eb7c062ee0f17a650a0e7ca7c9831"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6e7eb7c062ee0f17a650a0e7ca7c9831">&#9670;&nbsp;</a></span>zwave_s2_log_security_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zwave_s2_log_security_keys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__sl__log.html#gacd69524374ffb27db69ca4d5ed0e6851">sl_log_level_t</a>&#160;</td>
          <td class="paramname"><em>log_level</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Logs the Security Keys using sl_log. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">log_level</td><td>The Log leve to use to log the keys. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gac49dbe5742fe551166c94f1123e9ab79" name="gac49dbe5742fe551166c94f1123e9ab79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac49dbe5742fe551166c94f1123e9ab79">&#9670;&nbsp;</a></span>zwave_s2_save_security_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zwave_s2_save_security_keys </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Save the Z-Wave Security Keys in a file in Zniffer friendly format. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>Name/path of the file where keys should be saved </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Aug 7 2024 15:21:46 for Z-Wave Protocol Controller Refrence by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
